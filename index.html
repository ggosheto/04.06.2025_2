<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Prolog за Цветя с GIF</title>
<style>
  body {
    font-family: 'Poppins', Arial, sans-serif;
    margin: 30px;
    background: linear-gradient(135deg, #a0e9ff 0%, #f0dfff 100%);
    color: #2a3a35;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
  }

  h1 {
    color: #3a7d44;
    text-align: center;
    font-weight: 700;
    font-size: 3rem;
    margin-bottom: 40px;
    text-shadow: 1px 1px 3px #9dc3a5;
  }

  #queryInput {
    width: 100%;
    max-width: 600px;
    padding: 16px 20px;
    font-size: 1.3rem;
    border: 3px solid #3a7d44;
    border-radius: 40px;
    outline: none;
    transition: box-shadow 0.3s ease, border-color 0.3s ease;
    box-shadow: 0 4px 10px #95bf8a44;
  }
  #queryInput::placeholder {
    font-style: italic;
    color: #69986f;
  }
  #queryInput:focus {
    border-color: #60b347;
    box-shadow: 0 0 15px #60b347cc;
  }

  #runBtn {
    margin-top: 20px;
    padding: 14px 50px;
    font-size: 1.25rem;
    background: linear-gradient(45deg, #4caf50, #81c784);
    border: none;
    border-radius: 50px;
    color: white;
    font-weight: 700;
    cursor: pointer;
    box-shadow: 0 6px 20px #4caf5077;
    transition: background 0.4s ease, box-shadow 0.4s ease, transform 0.2s ease;
  }
  #runBtn:hover {
    background: linear-gradient(45deg, #81c784, #4caf50);
    box-shadow: 0 10px 30px #4caf50bb;
    transform: scale(1.05);
  }
  #runBtn:active {
    transform: scale(0.95);
  }

  #result {
    margin-top: 40px;
    max-width: 650px;
    background: rgba(255,255,255,0.95);
    padding: 30px 35px;
    border-radius: 25px;
    box-shadow: 0 10px 30px #7cb67255;
    font-size: 1.25rem;
    min-height: 170px;
    color: #2a3a35;
  }

  #result h3 {
    color: #4caf50;
    margin-bottom: 20px;
    font-weight: 700;
    text-shadow: 1px 1px 2px #a0d49a;
  }

  #result p {
    margin: 12px 0;
    line-height: 1.4;
  }

  .flower-gif {
    display: block;
    margin: 25px auto 0 auto;
    max-width: 320px;
    border-radius: 20px;
    box-shadow: 0 10px 30px #4caf5077;
    cursor: pointer;
    transition: transform 0.4s ease, box-shadow 0.4s ease;
    border: 4px solid transparent;
  }
  .flower-gif:hover {
    transform: scale(1.12) rotate(4deg);
    box-shadow: 0 18px 45px #4caf50cc;
    border-color: #81c784;
  }

  /* Responsive */
  @media (max-width: 700px) {
    #queryInput, #result {
      max-width: 95vw;
      font-size: 1.1rem;
    }
    h1 {
      font-size: 2.3rem;
    }
    #runBtn {
      width: 100%;
      padding: 14px 0;
    }
  }
</style>
</head>
<body>

<h1>Prolog за Цветя с GIF</h1>

<input id="queryInput" type="text" placeholder="Въведете Prolog заявка, напр. is_flowering(X)." autocomplete="off" />
<button id="runBtn">Изпълни</button>

<div id="result"></div>

<script src="https://cdn.jsdelivr.net/npm/tau-prolog@0.3.2/modules/core.js"></script>
<script src="https://cdn.jsdelivr.net/npm/tau-prolog@0.3.2/modules/lists.js"></script>
<script>
// Променлива knowledge съдържа Prolog базата с цветя и правила
const knowledge = `
flower(rose).
flower(tulip).
flower(sunflower).
flower(lavender).
flower(daisy).

is_flowering(X) :- flower(X).
is_tall(sunflower).
is_aromatic(rose).
is_aromatic(lavender).
is_colorful(tulip).
is_colorful(daisy).

% Пример на правило: цъфтящо и ароматно цвете
is_flowering_and_aromatic(X) :- is_flowering(X), is_aromatic(X).
`;

// Обект с GIF за всяко цвете (с проверени и подходящи линкове)
const flowerAnimations = {
  rose: '<img src="https://media.giphy.com/media/26BRBupaLr2jpWq1O/giphy.gif" class="flower-gif" alt="Rose" title="Rose" />',
  tulip: '<img src="https://media.giphy.com/media/3oEjHCWdU7F4Tb4U1a/giphy.gif" class="flower-gif" alt="Tulip" title="Tulip" />',
  sunflower: '<img src="https://media.giphy.com/media/6TPfUt1Whb6lS/giphy.gif" class="flower-gif" alt="Sunflower" title="Sunflower" />',
  lavender: '<img src="https://media.giphy.com/media/l41lXagLsaQ9o1oJi/giphy.gif" class="flower-gif" alt="Lavender" title="Lavender" />',
  daisy: '<img src="https://media.giphy.com/media/l2JHRhAtnJSDNJ2py/giphy.gif" class="flower-gif" alt="Daisy" title="Daisy" />',
};

const session = pl.create(1000);
session.consult(knowledge);

const queryInput = document.getElementById("queryInput");
const runBtn = document.getElementById("runBtn");
const resultDiv = document.getElementById("result");

runBtn.addEventListener("click", () => {
  const query = queryInput.value.trim();
  if (!query) {
    resultDiv.innerHTML = "<p>Моля, въведете Prolog заявка.</p>";
    return;
  }

  resultDiv.innerHTML = "<p>Търсене...</p>";

  session.query(query);

  let answers = [];
  session.answers(answer => {
    if (answer === false) {
      // Край на решенията
      if (answers.length === 0) {
        resultDiv.innerHTML = "<p>Няма намерени решения.</p>";
      } else {
        displayResults(answers);
      }
    } else {
      answers.push(answer);
    }
  });
});

function displayResults(answers) {
  let outputHTML = "<h3>Намерени решения:</h3>";
  for (let ans of answers) {
    const vars = Object.keys(ans.links);
    let varsOutput = vars.map(v => {
      const val = ans.links[v].toString();
      return `<b>${v}</b> = ${val}`;
    }).join(", ");

    outputHTML += `<p>${varsOutput}</p>`;

    for (let v of vars) {
      const val = ans.links[v].toString();
      if (flowerAnimations[val]) {
        outputHTML += flowerAnimations[val];
      }
    }
  }
  resultDiv.innerHTML = outputHTML;
}
</script>

</body>
</html>
